#!/bin/zsh


push=$(git push 2>&1)

if [[ "$push" =~ "fatal:.*no\supstream.*" ]]; then
    stream_cmd=$(echo "$push" | grep -oE "(git.*set\-upstream.*)");
    echo "Running:  $stream_cmd \n";
    push_output=$(eval "$stream_cmd" 2>&1);
    echo "Push output: $push_output\n";
    url=$(echo "$push_output" | grep -oP "\s+\K(.*pull\/new.*)");
    echo "URL: $url\n";
    xdg-open "$url";
fi

